/**
 * Pager, lister, filter of the table
 * @author Eduardo Rafael Correa de Souza
 * @param {object} opt
 */
$.fn.pager=function(e){var t=$.extend({columns:[{name:"name",label:"Nome"},{name:"email",label:"Email"}],sorter:{name:false,order:false},pk:"",filter:"",url:"",next:"icon-arrow-right-2",prev:"icon-arrow-left-2",asc:"icon-arrow-up-2",desc:"icon-arrow-down-2"},e);var n=$(this);var r=1;var i=$("<table/>");var s=false;$(n).append(i);var o=function(){var e=$("<thead/>");var n=$("<tr/>");var r,s;for(var o in t.columns){s=t.columns[o];r=$("<th/>");$(r).attr("rel",s.name).attr("rel-label",s.label).html(s.label).click(function(){var e=$("<i/>").addClass(t.asc);var n=$("<span/>").html($(this).attr("rel-label"));t.sorter.name=$(this).attr("rel");t.sorter.order="ASC";if($(this).find("i").length>0){if($(this).find("i").hasClass(t.asc)){t.sorter.order="DESC";$(e).removeClass(t.asc).addClass(t.desc)}}$("th",i).find("i").remove();$(this).html("");$(this).append(e,n);c()});n.append(r)}e.append(n);return e};var u=function(e){var n=$("<tbody/>");var r,i,s,o,u;for(s in e){u=e[s];r=$("<tr/>");$(r).attr("rel",u[t.pk]);$(r).addClass(s%2===0?"even":"odd");for(o in t.columns){i=$("<td/>");$(i).html(u[t.columns[o].name]);$(r).append(i)}n.append(r)}return n};var a=function(e){$(n).find(".jqpager-commanders").remove();var i=$("<div/>").addClass("jqpager-commanders");if(e!==undefined){var s=$("<ul />");var o=$("<li/>");var u=$("<li/>");var a=$("<li/>");var h=$("<li/>").html("página de "+e.total+" páginas");var p=$("<i/>").addClass(t.prev).click(f);var d=$("<i/>").addClass(t.next).click(l);var v=$("<input/>").addClass("jqpager-curpage").html(r).blur(function(){r=$(this).val();c()}).keyup(function(e){if(e.keyCode===13){r=$(this).val();c()}}).val(r);$(o).append(p);$(u).append(v);$(a).append(d);$(s).append(o);$(s).append(u);$(s).append(h);$(s).append(a);$(s).appendTo(i)}return i};var f=function(){r--;c()};var l=function(){r++;c()};var c=function(){var e=$(t.form).serialize();if(t.sorter.name){if(!t.sorter.order){t.sorter.order="ASC"}e+="&sortname="+t.sorter.name+"&sortorder="+t.sorter.order}e+="&curpage="+r;$.ajax({url:t.url,data:e,type:"POST",dataType:"JSON",success:function(e){var t=u(e.data);r=e.current;$(i).find("tbody").remove();$(i).append(t);$(n).append(a(e));h()}})};var h=function(){var e=$(i).find("tbody");$("tr",e).click(function(){if($(this).hasClass("active")){if(!s){$("tr",e).removeClass("active");}else{$(this).removeClass("active")}}else{if(!s){$("tr",e).removeClass("active")}$(this).addClass("active")}})};var p=function(){$(document).keydown(function(e){if(e.keyCode===17){s=true}}).keyup(function(e){if(e.keyCode===17){s=false}})};$(t.form).submit(function(){c();return false});$(i).append(o()).addClass("jqpager");c();p()}